<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Playa Juan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1">
  <meta name="description" content="Aplicación de gestión de hamacas para Playa Juan">
  <meta name="theme-color" content="#20B2AA">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Playa Juan">
  <!-- Estilos externos -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.css">
  <!-- Scripts externos -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="./style.css">
  <link rel="manifest" href="./manifest.json">
  <!-- Iconos para iOS -->
  <link rel="apple-touch-icon" href="./icon-192x192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="./icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./icon-180x180.png">
  <link rel="apple-touch-icon" sizes="167x167" href="./icon-167x167.png">
  <!-- Splash screens para iOS -->
  <link rel="apple-touch-startup-image" href="./splash-640x1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)">
  <link rel="apple-touch-startup-image" href="./splash-750x1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)">
  <link rel="apple-touch-startup-image" href="./splash-1242x2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3)">
  <link rel="apple-touch-startup-image" href="./splash-1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">
  <!-- Icono principal -->
  <link rel="icon" href="./icon-192x192.png">
</head>
<body>
  <div id="db-connection-btn" class="db-connection-btn">
    <span class="connection-status">●</span>
    <span class="connection-text">Conectado</span>
  </div>

<div class="beach_wrapper zoom">
  <div class="sunbed toggle">
    <label class="sunbed_name"></label>
    <div>
      <form class="form">
        <input type="text" class="customer_name">
      </form>
    </div>
    <!-- Aquí añades el círculo -->
   <div class="circle toggle" id="circle1" data-actual-step="0"></div>
<div class="circle toggle" id="circle2" data-actual-step="0"></div>
<div class="circle toggle" id="circle3" data-actual-step="0"></div>
<!-- Puedes agregar más círculos según lo necesites -->
<!-- Agrega más círculos según sea necesario -->
  </div>
  <!-- Repite la estructura para más hamacas -->



  <!-- Calculadora de cobro -->
<!-- Calculadora de cobro -->
<div class="calculator-footer zoom-normal">
  <h2>Cobro</h2>
  <div id="fecha-cobro" style="font-size:50px; color:#666; margin-bottom:10px;"></div>

  <label for="hamaca">Hamaca:</label>
  <input type="number" id="hamaca" placeholder="" required>

  <label for="totalSelect">Pagar&nbsp;(€):</label>
  <select id="totalSelect">
    <option value="8">8€ 1 hamaca</option>
    <option value="16">16€ 2 hamacas</option>
    <option value="24">24€ 3 hamacas</option>
    <option value="32">32€ 4 hamacas</option>
    <option value="40">40€ 5 hamacas</option>
    <option value="48">48€ 6 hamacas</option>
    <option value="56">56€ 7 hamacas</option>
    <option value="64">64€ 8 hamacas</option>
    <option value="72">72€ 9 hamacas</option>
    <option value="80">80€ 10 hamacas</option>
  </select>
  <input type="number" id="totalManual" placeholder="Otra cantidad" step="0.01">

  <label for="recibidoManual">Recibido&nbsp;(€):</label>
  <input type="number" id="recibidoManual" placeholder="" step="0.01">

    <div class="switch-container">
      <span class="switch-text-left">Efectivo</span>
      <label class="switch">
        <input type="checkbox" id="pago">
        <span class="slider round"></span>
      </label>
      <span class="switch-text-right">Tarjeta</span>
    </div>

    <div class="switch-group">
      <div class="switch-header">Sombrilla extra:</div>
      <div class="switch-container">
        <span class="switch-text-left">No</span>
        <label class="switch">
          <input type="checkbox" id="sombrillaExtra">
          <span class="slider round"></span>
        </label>
        <span class="switch-text-right">Sí (+4€)</span>
      </div>
    </div>

  <button onclick="calcularCambio()">Calcular</button>

  <div class="cambio" id="resultado"></div>

  <div class="registro">
    <h4>Registro Total <span class="fecha" id="fecha"></span></h4>
    <p>Efectivo acumulado: €<span id="totalEfectivo">0.00</span></p>
    <p>Tarjeta acumulado: €<span id="totalTarjeta">0.00</span></p>
    <p><strong>Total general: €<span id="totalGeneral">0.00</span></strong></p>

    <button id="mostrarHistorial" onclick="toggleHistorial()">Mostrar Historial</button>

    <div id="historialContainer">
      <h4>Historial de pagos:</h4>
      <ul id="historial"></ul>
      <div class="historial-nav">
        <button onclick="scrollHistorial('up')">↑</button>
        <button onclick="scrollHistorial('down')">↓</button>
      </div>
    </div>

    <!-- Botones debajo -->
    <div class="button-container">
      <button onclick="reiniciarCalculadora()">Reiniciar calculadora</button>
      <button onclick="procesarDevolucion()">Devolución</button> 
    </div>
  </div>
</div>
<!-- Scripts personalizados -->

<!-- Menú contextual de colores -->
<div id="colorContextMenu" class="color-context-menu" style="display: none;">
    <div class="color-option step1" data-step="1" title="Disponible"></div>
    <div class="color-option step2" data-step="2" title="Ocupado"></div>
    <div class="color-option step3" data-step="3" title="Reservado"></div>
    <div class="color-option step4" data-step="4" title="Mantenimiento"></div>
    <div class="color-option step5" data-step="5" title="Especial"></div>
    <div class="color-option step6" data-step="6" title="No disponible"></div>
</div>

<!-- Botonera anclada abajo -->
<div class="botonera-fija">
  <button class="fab" id="menu-toggle">☰</button>
  <div class="menu-desplegable" id="menu-desplegable">
    <button onclick="SunbedController.reset_local_storage_except_customers();">Reset Colors</button>
    <button onclick="toggleDesconectadosFila0(1)">Fila0</button>
    <button onclick="toggledesconectadosFila1(1)">Fila1</button>
    <button onclick="toggledesconectadosFila2(1)">Fila2</button>
    <button onclick="toggledesconectadosFila3(1)">Fila3</button>
    <button onclick="toggledesconectadosFila4(1)">Fila4</button>
    <button onclick="toggleDesconectadosFila8(1)">Fila8</button>
    <button onclick="toggleZonalibre()">ZonaLibre1</button>
    <button onclick="toggleZonalibre2(1)">ZonaLibre2</button>
    <button onclick="toggleclon10A(1)">Clon10A</button>
    <button onclick="toggleclon0(1)">Clon0</button>
    <button onclick="toggleCircles()">Sombrillas</button>
    <button onclick="clearClick(1)">Resetear Todo</button>
  </div>
</div>
<!-- Fin botonera anclada abajo -->

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
  // Configuración de Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyBpTV1quq0mX0fQ9f33a0n3SMHFvFUknek",
    authDomain: "movil-26943.firebaseapp.com",
    databaseURL: "https://movil-26943-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "movil-26943",
    storageBucket: "movil-26943.firebasestorage.app",
    messagingSenderId: "978593311158",
    appId: "1:978593311158:web:7464a2e217a70ee215b917"
  };

  // Inicializar Firebase y asegurarnos de que esté disponible globalmente
  window.firebaseApp = firebase.initializeApp(firebaseConfig);
  window.db = window.firebaseApp.database();

  // Verificar que Firebase está inicializado correctamente
  if (!window.db) {
    console.error('Error: Firebase no se ha inicializado correctamente');
  } else {
    console.log('Firebase inicializado correctamente');
  }
</script>

<!-- Scripts personalizados DESPUÉS de Firebase -->
<script>
  // Esperar a que Firebase esté listo antes de cargar script.js
  window.addEventListener('load', function() {
    if (window.db) {
      const scriptJs = document.createElement('script');
      scriptJs.src = './script.js';
      scriptJs.onload = function() {
        console.log('script.js cargado correctamente');
      };
      scriptJs.onerror = function(error) {
        console.error('Error al cargar script.js:', error);
      };
      document.body.appendChild(scriptJs);
    } else {
      console.error('Firebase no está disponible. No se cargará script.js');
    }
  });
</script>

<!-- Service Worker registration -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js', {
        scope: './'
      })
      .then((reg) => { 
        console.log("Service Worker registrado correctamente");
        console.log("Scope:", reg.scope);
      })
      .catch((err) => { 
        console.error("Error al registrar el Service Worker:", err);
      });
  });
}
</script>
</body>
</html>
